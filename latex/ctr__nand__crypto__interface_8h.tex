\hypertarget{ctr__nand__crypto__interface_8h}{}\section{include/ctr9/io/ctr\+\_\+nand\+\_\+crypto\+\_\+interface.h File Reference}
\label{ctr__nand__crypto__interface_8h}\index{include/ctr9/io/ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{include/ctr9/io/ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}}
{\ttfamily \#include \char`\"{}ctr\+\_\+io\+\_\+interface.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}sdmmc/sdmmc.\+h\char`\"{}}\\*
{\ttfamily \#include $<$stdint.\+h$>$}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structctr__nand__crypto__interface}{ctr\+\_\+nand\+\_\+crypto\+\_\+interface}
\begin{DoxyCompactList}\small\item\em Filter io interface to apply encryption while reading N\+A\+ND. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum {\bfseries ctr\+\_\+nand\+\_\+crypto\+\_\+type} \{ {\bfseries N\+A\+N\+D\+\_\+\+C\+TR}, 
{\bfseries N\+A\+N\+D\+\_\+\+T\+WL}
 \}\hypertarget{ctr__nand__crypto__interface_8h_a8a1a54420fc4fa8cb204039752540f48}{}\label{ctr__nand__crypto__interface_8h_a8a1a54420fc4fa8cb204039752540f48}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{ctr__nand__crypto__interface_8h_aa02d30f5d5dd6a5b3b8dd4fbd31d23a4}{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+initialize} (\hyperlink{structctr__nand__crypto__interface}{ctr\+\_\+nand\+\_\+crypto\+\_\+interface} $\ast$io, uint8\+\_\+t key\+\_\+slot, ctr\+\_\+nand\+\_\+crypto\+\_\+type crypto\+\_\+type, \hyperlink{structctr__io__interface}{ctr\+\_\+io\+\_\+interface} $\ast$lower\+\_\+io)
\begin{DoxyCompactList}\small\item\em Initialize the given N\+A\+ND crypto io interface object. \end{DoxyCompactList}\item 
void \hyperlink{ctr__nand__crypto__interface_8h_ae1cb1e651153f176eeee132425f06610}{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+destroy} (\hyperlink{structctr__nand__crypto__interface}{ctr\+\_\+nand\+\_\+crypto\+\_\+interface} $\ast$io)
\begin{DoxyCompactList}\small\item\em Destroys the given N\+A\+ND crypto io interface object. \end{DoxyCompactList}\item 
int \hyperlink{ctr__nand__crypto__interface_8h_a34a61db38c5c15c5430030365fb28f16}{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read} (void $\ast$io, void $\ast$buffer, size\+\_\+t buffer\+\_\+size, size\+\_\+t position, size\+\_\+t count)
\begin{DoxyCompactList}\small\item\em Reads bytes from the given io interface. \end{DoxyCompactList}\item 
int \hyperlink{ctr__nand__crypto__interface_8h_a8788f706814ce38ffbf8bca6cf247bfc}{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write} (void $\ast$io, const void $\ast$buffer, size\+\_\+t buffer\+\_\+size, size\+\_\+t position)
\begin{DoxyCompactList}\small\item\em Writes bytes to the given io interface. \end{DoxyCompactList}\item 
int \hyperlink{ctr__nand__crypto__interface_8h_a2a3b4cc73cffeac0b47e998442f588d9}{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read\+\_\+sector} (void $\ast$io, void $\ast$buffer, size\+\_\+t buffer\+\_\+size, size\+\_\+t position, size\+\_\+t count)
\begin{DoxyCompactList}\small\item\em Reads sectors from the given io interface. \end{DoxyCompactList}\item 
int \hyperlink{ctr__nand__crypto__interface_8h_a9585dbd9c363059647f97c2f2a4d7ed0}{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write\+\_\+sector} (void $\ast$io, const void $\ast$buffer, size\+\_\+t buffer\+\_\+size, size\+\_\+t position)
\begin{DoxyCompactList}\small\item\em Writes sectors from the given io interface. \end{DoxyCompactList}\item 
size\+\_\+t \hyperlink{ctr__nand__crypto__interface_8h_a0c744875ae03ad16da5882837cd0c89f}{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+disk\+\_\+size} (void $\ast$io)
\begin{DoxyCompactList}\small\item\em Returns the size of the underlying disk for the given io interface. \end{DoxyCompactList}\item 
size\+\_\+t \hyperlink{ctr__nand__crypto__interface_8h_a209962c66bdc74684c31aa90d4359594}{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+sector\+\_\+size} (void $\ast$io)
\begin{DoxyCompactList}\small\item\em Returns the size of the sectors used by the underlying io interface. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+destroy@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+destroy}}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+destroy@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+destroy}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}}
\subsubsection[{\texorpdfstring{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+destroy(ctr\+\_\+nand\+\_\+crypto\+\_\+interface $\ast$io)}{ctr_nand_crypto_interface_destroy(ctr_nand_crypto_interface *io)}}]{\setlength{\rightskip}{0pt plus 5cm}void ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+destroy (
\begin{DoxyParamCaption}
\item[{{\bf ctr\+\_\+nand\+\_\+crypto\+\_\+interface} $\ast$}]{io}
\end{DoxyParamCaption}
)}\hypertarget{ctr__nand__crypto__interface_8h_ae1cb1e651153f176eeee132425f06610}{}\label{ctr__nand__crypto__interface_8h_ae1cb1e651153f176eeee132425f06610}


Destroys the given N\+A\+ND crypto io interface object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em io} & N\+A\+ND io interface to deinitialize.\\
\hline
\end{DoxyParams}
\begin{DoxyPostcond}{Postcondition}
The io interface has been destroyed and cannot be used for decrypting N\+A\+ND without being re-\/initialized. The lower\+\_\+io passed at construction/ iniitalization remains valid. 
\end{DoxyPostcond}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+disk\+\_\+size@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+disk\+\_\+size}}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+disk\+\_\+size@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+disk\+\_\+size}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}}
\subsubsection[{\texorpdfstring{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+disk\+\_\+size(void $\ast$io)}{ctr_nand_crypto_interface_disk_size(void *io)}}]{\setlength{\rightskip}{0pt plus 5cm}size\+\_\+t ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+disk\+\_\+size (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{io}
\end{DoxyParamCaption}
)}\hypertarget{ctr__nand__crypto__interface_8h_a0c744875ae03ad16da5882837cd0c89f}{}\label{ctr__nand__crypto__interface_8h_a0c744875ae03ad16da5882837cd0c89f}


Returns the size of the underlying disk for the given io interface. 

\begin{DoxyReturn}{Returns}
The size of the underlying io interface as reported by it. 
\end{DoxyReturn}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+initialize@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+initialize}}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+initialize@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+initialize}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}}
\subsubsection[{\texorpdfstring{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+initialize(ctr\+\_\+nand\+\_\+crypto\+\_\+interface $\ast$io, uint8\+\_\+t key\+\_\+slot, ctr\+\_\+nand\+\_\+crypto\+\_\+type crypto\+\_\+type, ctr\+\_\+io\+\_\+interface $\ast$lower\+\_\+io)}{ctr_nand_crypto_interface_initialize(ctr_nand_crypto_interface *io, uint8_t key_slot, ctr_nand_crypto_type crypto_type, ctr_io_interface *lower_io)}}]{\setlength{\rightskip}{0pt plus 5cm}int ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+initialize (
\begin{DoxyParamCaption}
\item[{{\bf ctr\+\_\+nand\+\_\+crypto\+\_\+interface} $\ast$}]{io, }
\item[{uint8\+\_\+t}]{key\+\_\+slot, }
\item[{ctr\+\_\+nand\+\_\+crypto\+\_\+type}]{crypto\+\_\+type, }
\item[{{\bf ctr\+\_\+io\+\_\+interface} $\ast$}]{lower\+\_\+io}
\end{DoxyParamCaption}
)}\hypertarget{ctr__nand__crypto__interface_8h_aa02d30f5d5dd6a5b3b8dd4fbd31d23a4}{}\label{ctr__nand__crypto__interface_8h_aa02d30f5d5dd6a5b3b8dd4fbd31d23a4}


Initialize the given N\+A\+ND crypto io interface object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em io} & N\+A\+ND io crypto interface to initialize. \\
\hline
\mbox{\tt in}  & {\em key\+\_\+slot} & Nintendo 3\+DS A\+ES key slot to use for C\+TR. \\
\hline
\mbox{\tt in}  & {\em crypto\+\_\+type} & Type of the system to taylor encryption to. C\+TR and T\+WL sections handle encryption slightly differently. \\
\hline
\mbox{\tt in,out}  & {\em lower\+\_\+io} & io interface to use as N\+A\+ND. The filter does not gain ownership of the lower\+\_\+io interface, it merely uses it. This pointer must remain valid while the crypto io interface object is in use.\\
\hline
\end{DoxyParams}
\begin{DoxyPostcond}{Postcondition}
The io interface has been initialized and can be used for decrypting N\+A\+ND. 
\end{DoxyPostcond}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read}}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}}
\subsubsection[{\texorpdfstring{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read(void $\ast$io, void $\ast$buffer, size\+\_\+t buffer\+\_\+size, size\+\_\+t position, size\+\_\+t count)}{ctr_nand_crypto_interface_read(void *io, void *buffer, size_t buffer_size, size_t position, size_t count)}}]{\setlength{\rightskip}{0pt plus 5cm}int ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{io, }
\item[{void $\ast$}]{buffer, }
\item[{size\+\_\+t}]{buffer\+\_\+size, }
\item[{size\+\_\+t}]{position, }
\item[{size\+\_\+t}]{count}
\end{DoxyParamCaption}
)}\hypertarget{ctr__nand__crypto__interface_8h_a34a61db38c5c15c5430030365fb28f16}{}\label{ctr__nand__crypto__interface_8h_a34a61db38c5c15c5430030365fb28f16}


Reads bytes from the given io interface. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em io} & The io interface to use for reading. \\
\hline
\mbox{\tt out}  & {\em buffer} & Pointer to the buffer. \\
\hline
\mbox{\tt in}  & {\em buffer\+\_\+size} & The size of the buffer in bytes. \\
\hline
\mbox{\tt in}  & {\em position} & Position/address in the io interface to read from. \\
\hline
\mbox{\tt in}  & {\em count} & The number of bytes to read.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 upon success, anything else means an error. 
\end{DoxyReturn}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read\+\_\+sector@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read\+\_\+sector}}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read\+\_\+sector@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read\+\_\+sector}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}}
\subsubsection[{\texorpdfstring{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read\+\_\+sector(void $\ast$io, void $\ast$buffer, size\+\_\+t buffer\+\_\+size, size\+\_\+t position, size\+\_\+t count)}{ctr_nand_crypto_interface_read_sector(void *io, void *buffer, size_t buffer_size, size_t position, size_t count)}}]{\setlength{\rightskip}{0pt plus 5cm}int ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+read\+\_\+sector (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{io, }
\item[{void $\ast$}]{buffer, }
\item[{size\+\_\+t}]{buffer\+\_\+size, }
\item[{size\+\_\+t}]{position, }
\item[{size\+\_\+t}]{count}
\end{DoxyParamCaption}
)}\hypertarget{ctr__nand__crypto__interface_8h_a2a3b4cc73cffeac0b47e998442f588d9}{}\label{ctr__nand__crypto__interface_8h_a2a3b4cc73cffeac0b47e998442f588d9}


Reads sectors from the given io interface. 

Uses whatever the underlying io interface uses for sector size.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em io} & The io interface to use for reading. \\
\hline
\mbox{\tt out}  & {\em buffer} & Pointer to the buffer. \\
\hline
\mbox{\tt in}  & {\em buffer\+\_\+size} & The size of the buffer in bytes. \\
\hline
\mbox{\tt in}  & {\em sector} & Sector position in the io interface to read from. \\
\hline
\mbox{\tt in}  & {\em count} & The number of sectors to read.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 upon success, anything else means an error. 
\end{DoxyReturn}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+sector\+\_\+size@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+sector\+\_\+size}}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+sector\+\_\+size@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+sector\+\_\+size}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}}
\subsubsection[{\texorpdfstring{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+sector\+\_\+size(void $\ast$io)}{ctr_nand_crypto_interface_sector_size(void *io)}}]{\setlength{\rightskip}{0pt plus 5cm}size\+\_\+t ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+sector\+\_\+size (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{io}
\end{DoxyParamCaption}
)}\hypertarget{ctr__nand__crypto__interface_8h_a209962c66bdc74684c31aa90d4359594}{}\label{ctr__nand__crypto__interface_8h_a209962c66bdc74684c31aa90d4359594}


Returns the size of the sectors used by the underlying io interface. 

\begin{DoxyReturn}{Returns}
The size in bytes of the underlying io interface. 
\end{DoxyReturn}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write}}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}}
\subsubsection[{\texorpdfstring{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write(void $\ast$io, const void $\ast$buffer, size\+\_\+t buffer\+\_\+size, size\+\_\+t position)}{ctr_nand_crypto_interface_write(void *io, const void *buffer, size_t buffer_size, size_t position)}}]{\setlength{\rightskip}{0pt plus 5cm}int ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{io, }
\item[{const void $\ast$}]{buffer, }
\item[{size\+\_\+t}]{buffer\+\_\+size, }
\item[{size\+\_\+t}]{position}
\end{DoxyParamCaption}
)}\hypertarget{ctr__nand__crypto__interface_8h_a8788f706814ce38ffbf8bca6cf247bfc}{}\label{ctr__nand__crypto__interface_8h_a8788f706814ce38ffbf8bca6cf247bfc}


Writes bytes to the given io interface. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em io} & The io interface to use for writing. \\
\hline
\mbox{\tt in}  & {\em buffer} & Pointer to the buffer. \\
\hline
\mbox{\tt in}  & {\em buffer\+\_\+size} & The size of the buffer, and the number of bytes to write. \\
\hline
\mbox{\tt in}  & {\em position} & Position/address in the io interface to write to.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 upon success, anything else means an error. 
\end{DoxyReturn}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write\+\_\+sector@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write\+\_\+sector}}
\index{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write\+\_\+sector@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write\+\_\+sector}!ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h@{ctr\+\_\+nand\+\_\+crypto\+\_\+interface.\+h}}
\subsubsection[{\texorpdfstring{ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write\+\_\+sector(void $\ast$io, const void $\ast$buffer, size\+\_\+t buffer\+\_\+size, size\+\_\+t position)}{ctr_nand_crypto_interface_write_sector(void *io, const void *buffer, size_t buffer_size, size_t position)}}]{\setlength{\rightskip}{0pt plus 5cm}int ctr\+\_\+nand\+\_\+crypto\+\_\+interface\+\_\+write\+\_\+sector (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{io, }
\item[{const void $\ast$}]{buffer, }
\item[{size\+\_\+t}]{buffer\+\_\+size, }
\item[{size\+\_\+t}]{position}
\end{DoxyParamCaption}
)}\hypertarget{ctr__nand__crypto__interface_8h_a9585dbd9c363059647f97c2f2a4d7ed0}{}\label{ctr__nand__crypto__interface_8h_a9585dbd9c363059647f97c2f2a4d7ed0}


Writes sectors from the given io interface. 

Uses whatever the underlying io interface uses for sector size.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em io} & The io interface to use for writing. \\
\hline
\mbox{\tt in}  & {\em buffer} & Pointer to the buffer. \\
\hline
\mbox{\tt in}  & {\em buffer\+\_\+size} & The size of the buffer, and the number of bytes to write. If the number is not a multiple of the sector size, this function will only write all the full sectors it can, ignoring the end of the buffer that doesn\textquotesingle{}t fit a sector. \\
\hline
\mbox{\tt in}  & {\em sector} & Sector Position in the io interface to write to.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 upon success, anything else means an error. 
\end{DoxyReturn}
