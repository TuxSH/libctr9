<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>libctr9: include/ctr9/ctr_interrupt.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libctr9
   </div>
   <div id="projectbrief">Nintendo 3DS ARM9 library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ctr__interrupt_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ctr_interrupt.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
</div>
<p><a href="ctr__interrupt_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a9dac5917bfe08169bc49f52d59423b9e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ctr__interrupt_8h.html#a9dac5917bfe08169bc49f52d59423b9e">ctr_interrupt_enum</a> { <br />
&#160;&#160;<b>CTR_INTERRUPT_RESET</b>, 
<b>CTR_INTERRUPT_UNDEF</b>, 
<b>CTR_INTERRUPT_SWI</b>, 
<b>CTR_INTERRUPT_PREABRT</b>, 
<br />
&#160;&#160;<b>CTR_INTERRUPT_DATABRT</b>, 
<b>CTR_INTERRUPT_IRQ</b>, 
<b>CTR_INTERRUPT_FIQ</b>
<br />
 }<tr class="memdesc:a9dac5917bfe08169bc49f52d59423b9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerations for the different ARM9 CPU exceptions.  <a href="ctr__interrupt_8h.html#a9dac5917bfe08169bc49f52d59423b9e">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a9dac5917bfe08169bc49f52d59423b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af7a1f898800b6f7c0cb62f00af6cdb48"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af7a1f898800b6f7c0cb62f00af6cdb48"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ctr__interrupt_8h.html#af7a1f898800b6f7c0cb62f00af6cdb48">ctr_interrupt_global_disable</a> (void)</td></tr>
<tr class="memdesc:af7a1f898800b6f7c0cb62f00af6cdb48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disables FIQ and IRQ interrupts. <br /></td></tr>
<tr class="separator:af7a1f898800b6f7c0cb62f00af6cdb48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c5c1213bba944634a86632067b44082"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2c5c1213bba944634a86632067b44082"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ctr__interrupt_8h.html#a2c5c1213bba944634a86632067b44082">ctr_interrupt_global_enable</a> (void)</td></tr>
<tr class="memdesc:a2c5c1213bba944634a86632067b44082"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables FIQ and IRQ interrupts. <br /></td></tr>
<tr class="separator:a2c5c1213bba944634a86632067b44082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3bb67c1f7281071d99d3770c1908151"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ctr__interrupt_8h.html#af3bb67c1f7281071d99d3770c1908151">ctr_interrupt_prepare</a> (void)</td></tr>
<tr class="memdesc:af3bb67c1f7281071d99d3770c1908151"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the exception vectors in ITCM.  <a href="#af3bb67c1f7281071d99d3770c1908151">More...</a><br /></td></tr>
<tr class="separator:af3bb67c1f7281071d99d3770c1908151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0c528a04d8d7ceb1935b1d8e53517fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ctr__interrupt_8h.html#af0c528a04d8d7ceb1935b1d8e53517fe">ctr_interrupt_set</a> (<a class="el" href="ctr__interrupt_8h.html#a9dac5917bfe08169bc49f52d59423b9e">ctr_interrupt_enum</a> interrupt_type, void(*interrupt)(uint32_t *))</td></tr>
<tr class="memdesc:af0c528a04d8d7ceb1935b1d8e53517fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up a handler for the given exception.  <a href="#af0c528a04d8d7ceb1935b1d8e53517fe">More...</a><br /></td></tr>
<tr class="separator:af0c528a04d8d7ceb1935b1d8e53517fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="a9dac5917bfe08169bc49f52d59423b9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="ctr__interrupt_8h.html#a9dac5917bfe08169bc49f52d59423b9e">ctr_interrupt_enum</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumerations for the different ARM9 CPU exceptions. </p>
<p>These enumerations can be used as indices to set handlers for the exceptions with ctr_interrupt_set. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="af3bb67c1f7281071d99d3770c1908151"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ctr_interrupt_prepare </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the exception vectors in ITCM. </p>
<p>For this function to work, ITCM must be enabled and MPU must allow for writing and reading from 0x0000 to 0x8000. In addition, the stacks for the exception modes must be set up, else when trying to jump to the exception handling code, the stacks will be setup randomly and will most likely lead to a crash. </p>

</div>
</div>
<a class="anchor" id="af0c528a04d8d7ceb1935b1d8e53517fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ctr_interrupt_set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ctr__interrupt_8h.html#a9dac5917bfe08169bc49f52d59423b9e">ctr_interrupt_enum</a>&#160;</td>
          <td class="paramname"><em>interrupt_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(uint32_t *)&#160;</td>
          <td class="paramname"><em>interrupt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up a handler for the given exception. </p>
<p>When the user-provided handler is called when an exception is generated, the parameter given to the function is an array with the following data from before the exception: [ cpsr, sp, lr, r0-r12 ]</p>
<p>Note that lr is the lr as saved by the current exception mode, refer to the ARM documentation to see how much lr was modified relative to the PC of when the exceptiin was triggered. Any changes to any of the values in the input array WILL be written back to the corresponding registers when the exception returns, if the handler returns. This can be used to skip the instruction that caused a data abort, for example, by editing lr to skip it. Note that for lr adjustments, the mode of execution when the exception was triggered is important. Check the T bit of cpsr in the input array to determine the mode of execution when the exception was thrown.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">interrupt_type</td><td>Enumeration determining which exception to set up. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">interrupt</td><td>Handler to call when the exception is fired. The handler can be either Thumb or ARM code. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_1cb3efacbdfbff58b0b2bab1b2b6e008.html">ctr9</a></li><li class="navelem"><a class="el" href="ctr__interrupt_8h.html">ctr_interrupt.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
